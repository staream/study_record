---
layout: post
title: 	"8th chapter of Statistics"
date: 	2024-10-07 00:50:17 +0900
categories: KhuDa
---

8.1 선형회귀 원리의 확장

양적 변수의 관계 규정 방법
- 상관
- 회귀

안 되는 경우
- 다양한 설명변수
- 반응변수가 양적 변수가 아닌 범주형 변수
![alt text](image-18.png)

확장 방향성
- 설명변수의 개수, 유형
- 반응변수의 유형
- 회귀모형의 형태 변경

다중회귀
- 설명변수가 여러 개
- k개의 설명변수는 k+1개의 파라미터를 가진다.

편회귀계수(partial regression coefficient)
- b1,b2

다중회귀분석
- 최소제곱법을 이용하여 파라미터를 구하면, 데이터가 가장 잘 들어맞는 모형을 얻는다.

회귀평면
- 변수가 2개인 경우
- 설명 변수가 2개일 때 그래프를 그리면 평면으로 나온다.

![alt text](image-19.png)

편회귀계수와 그 유의성
- 편회귀계수는 모두 유의미.
- R^2 : 데이터에 잘 들어맞는지의 여부
- F통계량에서 얻은 p값

편회귀계수가 모두 0인 모형(R^2=0)
- p<0.05 : 설명력에 유의성이 있다.

#### 편회귀계수
표준화편회귀계수 고려사항
1. 회귀분석에서 구한 편회귀계수끼리의 비교시
    - 설명변수의 데이터 퍼짐
    - 단위
2. 이용하는 방법
    - 표준화편회귀계수(standardized partial regression coefficient)
        - 회귀분석 전에 설명변수를 평균 0, 표준편차 1로 변환한다.
3. 한계
    - 회귀모형의 설명력, 편회귀계수의 p값 등은 변화가 없다.
4. 해석
    - 계수 bi는 xi 이외의 설명변수를 고정한 채로 xi가 1늘어날 때의 y증가량을 나타낸다.
    - 상관이 있는 경우 다른 변수 x도 같이 움직인다.
        - 상관계수가 1에 가까운 강한 상관이 있는 경우, 다중 공선성 의심

#### 범주형 변수를 설명변수로
범주의 특징
- 대소 관계가 없다.
- 0또는 1과 같은 가변수(dummy variable)이 필요

![alt text](image-20.png)
회귀모형

##### 범주가 3개 이상일 때
- 혈액형은 0,1,2,3으로 표현할 수 없다.

sol
- (범주-1)개의 가변수를 이용한다.

범주의 특징
- 선형회귀는 p값 등의 해석 결과가 이표본 t검정이나 분산분석 결과와 일치한다.

##### 공분산분석
분산분석에서 집단 사이의 평균값을 비교한다.

회귀의 관점에선 범주 : 설명변수

양적 : 반응변수

공분산분석(analysis of covariance)
- 일반적인 분산분석에 사용하는 데이터와 함께 양적 변수 데이터가 있는 경우에 후보가 되는 방법

- 새로 추가한 양적 변수를 공변량(covariate)

![alt text](image-21.png)

분산분석 : 데이터 퍼짐을 해석한다.

공분산분석 : 공변량에 따른 분산으로써 분석할 수 있다.

- 사용 조건
    - 집단 간 회귀의 기울기가 다르지 않을 것
    - 회귀계수가 0이 아니어야 한다.
        - 0인 경우는 분산분석

##### 고차원 데이터
차원의 저주 : 차원이 늘어날수록 파라미터 추정에 필요한 **데이터 양이 늘어나는 것**
![alt text](image-22.png)

##### 다중공선성
설명변수 사이에 강한 상관이 있는 경우
- 회귀계수의 추정오차가 커지는 문제가 발생할 가능성이 있기에 신뢰성이 떨어진다.
    - 직선 관계에서 벗어난 값에 회귀계수가 영향을 받아 버려, 회귀계수를 해석하기 어려워진다.
찾는 방법
- VIF 분산팽창인수
    - 설명변수들 중에서 하나를 반응변수라고 설정하여 나머지 설명을 이용하여 회귀를 시행하여 R^2을 계산한다.
    ![alt text](image-24.png)

![alt text](image-23.png)

해석 
- vif>10
    - 상관이 아주 강하다.

해결 방법
- 개수 줄이기- 차원축소
    - 주성분분석
- 예측이 좋은 모형을 얻는 게 중요

#### 8.2 회귀모형의 형태 바꾸기

설명변수 간의 상승효과 : 상호작용

    변수간의 곱을 통해 도입할 수 있다.
<img src="image-25.png" width="px" height="250px" title="px(픽셀) 크기 설정" alt="network_visualization"></img><br/>

그래서 아래의 경우에 주로 사용한다.
<img src="image-26.png" width="px" height="250px" title="px(픽셀) 크기 설정" alt="network_visualization"></img><br/>

이원배치 분산분석
- 일원배치 분산분석 : 하나의 요인을 다룸
- 다원배치 분산분석 : 여러 개의 요인을 동시에 고려함.

예시 : 줄기 = 저/고온 + 비료 있/없음

이때 온도에 따른 비료의 관계가 있다면 **상호작용**항을 추가한 이원배치 분산분석을 시행.
![alt text](image-27.png)

가설검정 결과 상호작용항 c1이 유의미하지 않을 시
- 상호작용이 없음
- 주효과(main effect)를 그대로 평가

##### 비선형회귀
2차함수 적용시
- 계수의 해석이 어려워진다.
    - 처음부터 다차함수를 이용하는 것은 비추

비선형의 경우는 모형에 대한 합리적인 **이유**가 있어야 한다.

#### 8.3 일반화선형모형의 개념
일반선형모형(general linear model)
- 다중 변수로 이루어진 선형 모형
- 최소제곱법으로 파라미터 추정
- 설명이 양적, 범주인 경우 고려

추정하는 방안
- 확률분포
    - 최대우도법(최대가능도 방법)
        - 일반화선형모형(GLM, Generalized Linear Model)
- 통계모형화
    - 확률 모형을 가정하여, 파라미터를 추정하여 모형을 평가하는 과정

선형회귀에 적절하지 않은 상황
- 설명:양적 / 반응변수 : 범주형 인 경우

##### 가능도와 최대가능도
잔차를 통해 모형이 데이터에 들어맞는지의 여부를 판단했다.

하지만, 데이터에는 
- 거의 같은 값을 가지는 영역
- 데이터 퍼짐이 큰 영역이 있다.

그래서, 데이터를
- 확률적으로 생성되었다고 간주,
- 확률적으로 얼마나 나타나기 쉬운가?

![alt text](image-28.png)
가능도(우도, likelihood)라고 한다.

가능도가 크다는 것 == 세타에서 얻은 데이터가 나타나기 쉽다

이를 통해 파라미터 theta를 얻을 수 있다.

이 방법을 최대가능도방법, 최대가능도 추정이라고 한다.

최대가능도 방법
![alt text](image-29.png)
가장 확률분포와 겹치는게 많은 경우가 이에 해당한다.

##### 로지스틱 회귀(logistic regression)

조건 : 반응변수가 값이 2개인 범주형 변수인 경우 사용하는 회귀이다.
![alt text](image-30.png)
이는 로지스틱 함수로, 회귀식을 exp안에 넣어 구현했다.

나오는 값은 확률

이항분포
- 로지스틱 회귀에 사용
- 이산형 확률분포
- 일어남/일어나지 않음 2가지 상태
- p/ 1-p로 나타낸다.
- n이 커질수록 정규분포에 근사
<img src="image-31.png" width="px" height="200px" title="px(픽셀) 크기 설정" alt="network_visualization"></img><br/>

로지스틱 함수
- 정의역 : 모든 구간
- 치역 [0,1]
- 이항분포 파라미터 p를 나타내기 적합함.
- 수학적으로 다루기 쉽다.
- a : 평행이동 b: 변화 정도
    - b는 증가, 감소를 결정한다.
        - b가 0이 아니라면 관계가 있다는 뜻
- ax+b 부분을 선형예측변수라 한다.
- 연결함수 : 선형예측변수와 반응변수의 확률분포 파라미터를 잇는 함수
<img src="image-32.png" width="200px" height="150px" title="px(픽셀) 크기 설정" alt="network_visualization"></img><br/>

![alt text](image-33.png)

오즈비
- 로지스틱 회귀의 결과를 오즈비(OR, odds ratio)라는 값으로 평가할 수 있다.
- 오즈 : p와 1-p의 비율을 말한다.
    - p/1-p
- 오즈비 : 2개의 p와 q에 대한 2개의 오즈비율
    - OR= (p/(1-p))/(q/(1-q))
    - 1보다 크다면 확률 p가 q보다 일어나기 쉽다.
    - 오즈비를 자주 사용하는 이유
        1. 수학적 취급이 용이
        2. 특정 연구들에서는 위험비를 대신하여 오즈비를 사용한다.

푸아송 회귀
- 데이터가 음수가 아닌 정수인 경우
- 반응변수가 개수인 경우
- 푸아송 분포(확률분포)를 따르는 회귀.
- 회귀식은 푸아송 분포의 평균을 나타내는 파라미터를 이용
<img src="image-34.png" width="200px" height="200px" title="px(픽셀) 크기 설정" alt="network_visualization"></img><br/>

푸아송 분포
- 낮은 확률로 일어나는 무작위 사건에 대해
- 평균이 파라미터(인)번 일 때 몇 번 일어나는지를 나타내는 확률분포.
- 100번 중 k번 일어날 확률은
<img src="image-35.png" width="px" height="100px" title="px(픽셀) 크기 설정" alt="network_visualization"></img><br/>

- 평균을 나타내는 파라미터는 인, 
- 인은 동시에 분산이기도 한다.
- 평균과 분산이 독립이 아니다.

##### 다양한 일반화선형모형
![alt text](image-36.png)

과분산
- 현실 데이터에는 분포에서 규정된 평균과 분산의 관계보다도 분산이 큰 경우
- 푸아송 회귀에서 대처법 :
    - 분산>평균인 음이항 회귀를 이용
    - 개체차나 장소차 등의 데이터를 이용한 일반화선형혼합모형(GLMM)

일반화선형혼합모형(GLMM, generalized linear mixed model)
- 다른 장소 따라 특성을 감안하기 위해 고안한 변수 ri
- a+bx+ri
- a,b : 고정효과(fixed effect)
- ri : 임의효과(random effect)
    - 유연한 모형화가 가능하다.
    - 과분산에 대응할 수 있다.
        - 겹쳐보면 데이터 펴짐을 알 수 있기 때문이다.
     
<img src="image-37.png" width="px" height="250px" title="px(픽셀) 크기 설정" alt="network_visualization"></img><br/>

#### 8.4 통계모형의 평가와 비교

왈드 검정
- 일반적인 선형회귀모형과 마찬가지로 일반화선형모형에서도 추정한 회귀계수를 대상으로 이중 검정에 대한 가설검정을 시행할 수 있다.<br>데이터 퍼짐를 나타내는 표준오차를 이용하여     최대가능도 방법으로 얻은 추정값/표준오차를 왈드 통계량이라 한다.   왈드를 통해 신뢰구간이나 p값을 얻을 수 있다.  <br> 이를 왈드 검정이라 한다.

가능도비 검정
- 최대가능도 방법으로 얻은 통계모형을 비교하는 방법
- 모형이 데이터에 맞도록 개선되었는지의 여부를 확인한다.
- 조건 : 2개의 모형을 비교시 한쪽이 다른 한쪽을 포함하는 관계여야 한다.
![alt text](image-38.png)

- 최대가능도 L1,L2
- D가 커질수록 대립가설의 가능도가 커진다.
- 계산방법
    - 부트스트랩 방법 이용
        - 어떤 가정하에 무작위로 데이터를 생성하고 추정량의 성질을 조사하는 방법
![alt text](image-39.png)     

AIC
- 새로 얻을 데이터의 예측을 잘 하는지에 대한 여부로 모형의 좋음을 결정하는 지표
- AIC가 작다는 것은 가능도가 크다는 것이다.
- 제대로 맞추지 못하는 overfitting발생

BIC(베이즈 정보기준, Bayesian inframation, criterionSS)
- 표본크기에 따라 달라진다.
    - 표본크기가 클수록 파라미터 개수의 패널티가 커진다.

AICc, DIC 등이 있다.